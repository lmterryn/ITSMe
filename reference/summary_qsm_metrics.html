<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Returns a summary data.frame containing all the metrics defined by Terryn et
al. (2020). Also contains: X and Y-position, dbh, tree height, tree volume
and trunk volume. When tree point clouds are provided, dbh and tree height
are based on the point cloud instead of the QSM."><title>Summary structural metrics from QSMs — summary_qsm_metrics • ITSMe</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Summary structural metrics from QSMs — summary_qsm_metrics"><meta property="og:description" content="Returns a summary data.frame containing all the metrics defined by Terryn et
al. (2020). Also contains: X and Y-position, dbh, tree height, tree volume
and trunk volume. When tree point clouds are provided, dbh and tree height
are based on the point cloud instead of the QSM."><meta property="og:image" content="https://lmterryn.github.io/ITSMe/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ITSMe</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/ITSMe.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lmterryn/ITSMe/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Summary structural metrics from QSMs</h1>
      <small class="dont-index">Source: <a href="https://github.com/lmterryn/ITSMe/blob/HEAD/R/summary_metrics.R" class="external-link"><code>R/summary_metrics.R</code></a></small>
      <div class="d-none name"><code>summary_qsm_metrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns a summary data.frame containing all the metrics defined by Terryn et
al. (2020). Also contains: X and Y-position, dbh, tree height, tree volume
and trunk volume. When tree point clouds are provided, dbh and tree height
are based on the point cloud instead of the QSM.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">summary_qsm_metrics</span><span class="op">(</span></span>
<span>  <span class="va">QSMs_path</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"2.4.1"</span>,</span>
<span>  multiple <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sbr_normalisation <span class="op">=</span> <span class="st">"treeheight"</span>,</span>
<span>  sbl_normalisation <span class="op">=</span> <span class="st">"treeheight"</span>,</span>
<span>  sbd_normalisation <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>  cylindercutoff <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  PCs_path <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  extension <span class="op">=</span> <span class="st">".txt"</span>,</span>
<span>  buttress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  thresholdR2 <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  slice_thickness <span class="op">=</span> <span class="fl">0.06</span>,</span>
<span>  thresholdbuttress <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  maxbuttressheight <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  concavity <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  dtm <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  OUT_path <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>QSMs_path</dt>
<dd><p>A character with the path to the folder that contains the
treeQSMs. These files have to be of the format xxx_qsm.mat (xxx is the
unique tree id) or xxx_qsm_0.mat (0 at the end is for example the n-th QSM
that is made for tree xxx). Multiple QSMs can be present in one QSM file,
in this case set parameter multiple TRUE. When multiple QSMs are present
for one tree the mean of the values of the different QSMs is taken for that
tree as a final value for a certain feature.</p></dd>


<dt>version</dt>
<dd><p>A character indicating the version of TreeQSM that was used to
produce the QSMs (Default = "2.4.1"). Other possible versions are "2.4.0",
"2.0", "2.3.0", "2.3.1" and "2.3.2".</p></dd>


<dt>multiple</dt>
<dd><p>Logical (default = FALSE), indicates if a single .mat file
for one tree holds multiple QSMs at once.</p></dd>


<dt>sbr_normalisation</dt>
<dd><p>Character (default="treeheight"). Normalisation
parameter of <code><a href="stem_branch_radius_qsm.html">stem_branch_radius_qsm</a></code>.</p></dd>


<dt>sbl_normalisation</dt>
<dd><p>Character (default="treeheight"). Normalisation
parameter of <code><a href="stem_branch_length_qsm.html">stem_branch_length_qsm</a></code>.</p></dd>


<dt>sbd_normalisation</dt>
<dd><p>Character (default="no"). Normalisation parameter of
<code><a href="stem_branch_distance_qsm.html">stem_branch_distance_qsm</a></code>.</p></dd>


<dt>cylindercutoff</dt>
<dd><p>This is the cutoff radius in meters for which cylinders
are to be included in the total tree volume calculation. Default of 0
includes all cylinders.</p></dd>


<dt>PCs_path</dt>
<dd><p>A character with the path to the folder that contains the
tree point clouds. Default is NA when the point clouds are not available.
The point clouds are used to determine the DBH, tree height, projected
crown area and crown volume. The DBH and tree height obtained from the tree
point clouds are then used for the normalisation of the other features. The
point cloud files have to be of the format xxx_pc in order to link the tree
point cloud to its' respective treeQSM.</p></dd>


<dt>extension</dt>
<dd><p>A character refering to the file extension of the point
cloud files (default=".txt"). Can be ".txt", ".ply" or ".las". Only
relevant if the tree point clouds are available.</p></dd>


<dt>buttress</dt>
<dd><p>Logical (default=FALSE), indicates if the trees have
buttresses. Only relevant if the tree point clouds are available. Only
relevant if the tree point clouds are available.</p></dd>


<dt>thresholdR2</dt>
<dd><p>Numeric value (default=0.001). Parameter of the
<code><a href="dbh_pc.html">dbh_pc</a></code> function used to calculate the diameter at breast
height. Only relevant if the tree point cloud is available and buttress ==
FALSE.</p></dd>


<dt>slice_thickness</dt>
<dd><p>Numeric value (default = 0.06). Parameter of the
<code><a href="dbh_pc.html">dbh_pc</a></code> and <code><a href="dab_pc.html">dab_pc</a></code> functions used to calculate
the diameter at breast height and above buttresses. Only relevant if the
tree point cloud is available.</p></dd>


<dt>thresholdbuttress</dt>
<dd><p>Numeric value (default=0.001). Parameter of the
<code><a href="dab_pc.html">dab_pc</a></code> function used to calculate the diameter above
buttresses. Only relevant if the tree point clouds are available and
buttress == TRUE.</p></dd>


<dt>maxbuttressheight</dt>
<dd><p>Numeric value (default=7). Parameter of the
<code><a href="dab_pc.html">dab_pc</a></code> function used to calculate the diameter above
buttresses. Only relevant if the tree point clouds are available and
buttress == TRUE.</p></dd>


<dt>concavity</dt>
<dd><p>Numeric value (default=4) concavity for the computation of
the functional diameter using a concave hull based on
<code><a href="https://joelgombin.github.io/concaveman/reference/concaveman.html" class="external-link">concaveman</a></code>. This concavity value is used in the
functions <code><a href="dbh.html">dbh</a></code>, <code><a href="stem_branch_length_qsm.html">stem_branch_length_qsm</a></code>,
<code><a href="stem_branch_distance_qsm.html">stem_branch_distance_qsm</a></code>, <code><a href="dbh_height_ratio_qsm.html">dbh_height_ratio_qsm</a></code>,
<code><a href="dbh_volume_ratio_qsm.html">dbh_volume_ratio_qsm</a></code>, and
<code><a href="dbh_minradius_ratio_qsm.html">dbh_minradius_ratio_qsm</a></code>. Only relevant if the tree point
cloud is available.</p></dd>


<dt>dtm</dt>
<dd><p>The digital terrain model from <code><a href="tree_height_pc.html">tree_height_pc</a></code>.</p></dd>


<dt>r</dt>
<dd><p>Numeric value (default=5) r which determines the range taken for the
dtm from <code><a href="tree_height_pc.html">tree_height_pc</a></code>. Only relevant if a dtm is provided.</p></dd>


<dt>OUT_path</dt>
<dd><p>A character with name of the output file (including the path
to the folder), where the summary csv file should be saved or logical
(default=FALSE) in this case no csv file is produced.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The summary of all metrics from Terryn et al. (2020) as a data.frame.
The summary is saved in a csv file if an output folder is provided. If
multiple QSMs are provided for all trees the mean values and standard
deviations for each tree are also calculated and saved in 2 other csv
files. In this case the function returns a list of the summaries with the
means and standard deviations in the second and third element of the list
respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Metrics Terryn et al. (2020): stem branch angle (sba,
<code><a href="stem_branch_angle_qsm.html">stem_branch_angle_qsm</a></code>), stem branch cluster size (sbcs,
<code><a href="stem_branch_cluster_size_qsm.html">stem_branch_cluster_size_qsm</a></code>), stem branch radius (sbr,
<code><a href="stem_branch_radius_qsm.html">stem_branch_radius_qsm</a></code>), stem branch length (sbl,
<code><a href="stem_branch_length_qsm.html">stem_branch_length_qsm</a></code>), stem branch distance (sbd,
<code><a href="stem_branch_distance_qsm.html">stem_branch_distance_qsm</a></code>), dbh height ratio (dhr,
<code><a href="dbh_height_ratio_qsm.html">dbh_height_ratio_qsm</a></code>), dbh volume ratio (dvr,
<code><a href="dbh_volume_ratio_qsm.html">dbh_volume_ratio_qsm</a></code>), volume below 55 (vb55,
<code><a href="volume_below_55_qsm.html">volume_below_55_qsm</a></code>), cylinder length volume ratio (clvr,
<code><a href="cylinder_length_volume_ratio_qsm.html">cylinder_length_volume_ratio_qsm</a></code>), shedding ratio (sr,
<code><a href="shedding_ratio_qsm.html">shedding_ratio_qsm</a></code>), branch angle ratio (bar,
<code><a href="branch_angle_ratio_qsm.html">branch_angle_ratio_qsm</a></code>), relative volume ratio (rvr,
<code><a href="relative_volume_ratio_qsm.html">relative_volume_ratio_qsm</a></code>), crown start height (csh,
<code><a href="crown_start_height_qsm.html">crown_start_height_qsm</a></code>), crown height (ch,
<code><a href="crown_height_qsm.html">crown_height_qsm</a></code>), crown evenness (ce,
<code><a href="crown_evenness_qsm.html">crown_evenness_qsm</a></code>), crown diameter height ratio (cdhr,
<code><a href="crown_diameterheight_ratio_qsm.html">crown_diameterheight_ratio_qsm</a></code>), dbh minimum radius ratio (dmr,
<code><a href="dbh_minradius_ratio_qsm.html">dbh_minradius_ratio_qsm</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Terryn, L., Calders, K., Disney, M., Origo, N., Malhi, Y.,
Newnham, G., ... &amp; Verbeeck, H. (2020). Tree species classification using
structural features derived from terrestrial laser scanning. ISPRS Journal
of Photogrammetry and Remote Sensing, 168, 170-181.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Calculate the summary with default parameters and export to csv</span></span></span>
<span class="r-in"><span><span class="co"># recommended for non-buttressed trees</span></span></span>
<span class="r-in"><span><span class="va">summary</span> <span class="op">&lt;-</span> <span class="fu">summary_qsm_metrics</span><span class="op">(</span></span></span>
<span class="r-in"><span>  QSMs_path <span class="op">=</span> <span class="st">"path/to/folder/QSMs/"</span>,</span></span>
<span class="r-in"><span>  OUT_path <span class="op">=</span> <span class="st">"path/to/out/folder/"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># also using point cloud info</span></span></span>
<span class="r-in"><span><span class="va">summary</span> <span class="op">&lt;-</span> <span class="fu">summary_qsm_metrics</span><span class="op">(</span></span></span>
<span class="r-in"><span>  QSMs_path <span class="op">=</span> <span class="st">"path/to/folder/QSMs/"</span>,</span></span>
<span class="r-in"><span>  PCs_path <span class="op">=</span> <span class="st">"path/to/folder/PCs/"</span>,</span></span>
<span class="r-in"><span>  extension <span class="op">=</span> <span class="st">".txt"</span>,</span></span>
<span class="r-in"><span>  OUT_path <span class="op">=</span> <span class="st">"path/to/out/folder/"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Calculate the summary with non-default parameter values</span></span></span>
<span class="r-in"><span><span class="co"># recommended for buttressed trees</span></span></span>
<span class="r-in"><span><span class="va">summary</span> <span class="op">&lt;-</span> <span class="fu">summary_qsm_metrics</span><span class="op">(</span></span></span>
<span class="r-in"><span>  QSMs_path <span class="op">=</span> <span class="st">"path/to/folder/QSMs/"</span>,</span></span>
<span class="r-in"><span>  PCs_path <span class="op">=</span> <span class="st">"path/to/folder/PCs/"</span>,</span></span>
<span class="r-in"><span>  extension <span class="op">=</span> <span class="st">".txt"</span>, buttress <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  OUT_path <span class="op">=</span> <span class="st">"path/to/out/folder/"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louise Terryn.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

