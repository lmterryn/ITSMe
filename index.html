<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Individual Tree Structural Metrics • ITSMe</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Individual Tree Structural Metrics">
<meta name="description" content="With this package you can obtain structural metrics from individual tree point clouds and their respective quantitative structure models (treeQSM).">
<meta property="og:description" content="With this package you can obtain structural metrics from individual tree point clouds and their respective quantitative structure models (treeQSM).">
<meta property="og:image" content="https://lmterryn.github.io/ITSMe/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ITSMe</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/ITSMe.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lmterryn/ITSMe/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><p align="center">
<img src="reference/figures/ITSMe_logo_RGB_nobg.jpg" height="500"></p>
<div class="section level2">
<h2 id="goal">Goal<a class="anchor" aria-label="anchor" href="#goal"></a>
</h2>
<p>The goal of the <strong>ITSMe</strong> (Individual Tree Structural Metrics) R-package is to provide easy to use functions to quickly obtain structural metrics from individual tree point clouds and their respective quantitative structure models (QSMs).</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <strong>ITSMe</strong> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"lmterryn/ITSMe"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>If your installation is causing trouble try uninstalling and re-installing R and RStudio if possible.</p>
</div>
<div class="section level2">
<h2 id="input">Input<a class="anchor" aria-label="anchor" href="#input"></a>
</h2>
<p>The functions are developed for tree point clouds obtained with TLS and QSMs obtained with <a href="https://github.com/InverseTampere/TreeQSM" class="external-link">TreeQSM</a>. The functions can, however, also be used on tree point clouds obtained from UAV-LS or MLS. You always need to keep in mind that the accuracy of the metric measurements will depend on the quality of the data.</p>
<p>There is also an option to read QSMs generated by <a href="https://github.com/csiro-robotics/raycloudtools" class="external-link">RayCloudTools, RCT</a>. But at the moment the functions to calculate specific structural metrics only work for QSMs generated by treeQSM. However, several metrics such as the total tree volume can be directly extracted from the RCT QSM after reading it in using <strong>ITSMe</strong>.</p>
</div>
<div class="section level2">
<h2 id="individual-tree-structural-metrics">Individual tree structural metrics<a class="anchor" aria-label="anchor" href="#individual-tree-structural-metrics"></a>
</h2>
<p>Structural metrics that can be calculated with the <strong>ITSMe</strong> package are summarised in the tables below.</p>
<div class="section level3">
<h3 id="basic-structural-metrics">Basic structural metrics<a class="anchor" aria-label="anchor" href="#basic-structural-metrics"></a>
</h3>
<table class="table">
<colgroup>
<col width="36%">
<col width="41%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th>structural metric</th>
<th align="center">function name</th>
<th align="right">input</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>tree position</td>
<td align="center">tree_position_pc, dbh_pc, dbh_qsm</td>
<td align="right">point cloud</td>
</tr>
<tr class="even">
<td>diameter at breast height (m)</td>
<td align="center">dbh_pc, dbh_qsm</td>
<td align="right">point cloud, QSM</td>
</tr>
<tr class="odd">
<td>diameter above buttresses (m)</td>
<td align="center">dab_pc</td>
<td align="right">point cloud</td>
</tr>
<tr class="even">
<td>tree height (m)</td>
<td align="center">tree_height_pc, tree_height_qsm</td>
<td align="right">point cloud, QSM</td>
</tr>
<tr class="odd">
<td>projected area (m<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mn>2</mn></msup><annotation encoding="application/x-tex">^{2}</annotation></semantics></math>)</td>
<td align="center">projected_area_pc</td>
<td align="right">point cloud</td>
</tr>
<tr class="even">
<td>alpha volume (m<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mn>3</mn></msup><annotation encoding="application/x-tex">^{3}</annotation></semantics></math>)</td>
<td align="center">alpha_volume_pc</td>
<td align="right">point cloud</td>
</tr>
<tr class="odd">
<td>tree volume (m<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mn>3</mn></msup><annotation encoding="application/x-tex">^{3}</annotation></semantics></math>)</td>
<td align="center">tree_volume_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="even">
<td>trunk volume (m<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mn>3</mn></msup><annotation encoding="application/x-tex">^{3}</annotation></semantics></math>)</td>
<td align="center">trunk_volume_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="odd">
<td>total branch volume (m<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mn>3</mn></msup><annotation encoding="application/x-tex">^{3}</annotation></semantics></math>)</td>
<td align="center">total_branch_volume_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="even">
<td>total branch length (m)</td>
<td align="center">total_branch_length_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="odd">
<td>total cylinder length (m)</td>
<td align="center">total_cyl_length_qsm</td>
<td align="right">QSM</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="structural-metrics-from-terryn-et-al-2020">Structural metrics from Terryn et al. (2020)<a class="anchor" aria-label="anchor" href="#structural-metrics-from-terryn-et-al-2020"></a>
</h3>
<p>These are the metrics defined in <a href="https://doi.org/10.1016/j.isprsjprs.2020.08.009" class="external-link">Terryn et al. (2020)</a> which were adapted from <a href="https://doi.org/10.1016/j.rse.2016.12.002" class="external-link">Akerblom et al. (2017)</a> except for the branch angle ratio and the relative volume ratio. Definitions of the metrics can be found in the help files of the functions and the papers of Terryn et al. (2020) and Akerblom et al. (2017). Normalisation according to Terryn et al. (2020) as well as Akerblom et al. (2017) is possible through the normalisation parameter included in the functions of the metrics that were adapted by Terryn et al. (2020). If the tree point cloud is provided along with the TreeQSM in the functions, dbh and tree height values are based on the point clouds rather than the QSMs. When the buttress parameter is indicated “TRUE” the diameter above buttresses instead of the diameter at breast height is used.</p>
<table class="table">
<colgroup>
<col width="43%">
<col width="35%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th>structural metric</th>
<th align="center">function name</th>
<th align="right">input</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>stem branch angle (degrees)</td>
<td align="center">stem_branch_angle_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="even">
<td>stem branch cluster size</td>
<td align="center">stem_branch_cluster_size_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="odd">
<td>stem branch radius (-/m)</td>
<td align="center">stem_branch_radius_qsm</td>
<td align="right">QSM (+point cloud)</td>
</tr>
<tr class="even">
<td>stem branch length (-/m)</td>
<td align="center">stem_branch_length_qsm</td>
<td align="right">QSM (+point cloud)</td>
</tr>
<tr class="odd">
<td>stem branch distance (-/m)</td>
<td align="center">stem_branch_distance_qsm</td>
<td align="right">QSM (+point cloud)</td>
</tr>
<tr class="even">
<td>dbh tree height ratio</td>
<td align="center">dbh_height_ratio_qsm</td>
<td align="right">QSM (+point cloud)</td>
</tr>
<tr class="odd">
<td>dbh tree volume ratio (m<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><annotation encoding="application/x-tex">^{-2}</annotation></semantics></math>)</td>
<td align="center">dbh_volume_ratio_qsm</td>
<td align="right">QSM (+point cloud)</td>
</tr>
<tr class="even">
<td>volume below 55</td>
<td align="center">volume_below_55_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="odd">
<td>cylinder length volume ratio (m<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><annotation encoding="application/x-tex">^{-2}</annotation></semantics></math>)</td>
<td align="center">cylinder_length_volume_ratio_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="even">
<td>shedding ratio</td>
<td align="center">shedding_ratio_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="odd">
<td>branch angle ratio</td>
<td align="center">branch_angle_ratio_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="even">
<td>relative volume ratio</td>
<td align="center">relative_volume_ratio_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="odd">
<td>crown start height</td>
<td align="center">crown_start_height_qsm</td>
<td align="right">QSM (+point cloud)</td>
</tr>
<tr class="even">
<td>crown height</td>
<td align="center">crown_height_qsm</td>
<td align="right">QSM (+point cloud)</td>
</tr>
<tr class="odd">
<td>crown evenness</td>
<td align="center">crown_evenness_qsm</td>
<td align="right">QSM</td>
</tr>
<tr class="even">
<td>crown diameter crown height ratio</td>
<td align="center">crown_diameterheight_ratio_qsm</td>
<td align="right">QSM (+point cloud)</td>
</tr>
<tr class="odd">
<td>dbh minimum tree radius ratio</td>
<td align="center">dbh_minradius_ratio_qsm</td>
<td align="right">QSM (+point cloud)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>For complete workflows, have a look at the <strong>ITSMe</strong> vignette with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"ITSMe"</span><span class="op">)</span></span></code></pre></div>
<p>Calculating the diameter at breast height versus the diameter above buttresses of a tree:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lmterryn/ITSMe" class="external-link">ITSMe</a></span><span class="op">)</span></span>
<span><span class="co"># Read the point cloud file from the Specified path to the tree point cloud file</span></span>
<span><span class="va">pc_tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_tree_pc.html">read_tree_pc</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"path/to/point/cloud.txt"</span><span class="op">)</span></span>
<span><span class="co"># Use dbh_pc function with default parameters and plot the fit</span></span>
<span><span class="va">out_dbh</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbh_pc.html">dbh_pc</a></span><span class="op">(</span>pc <span class="op">=</span> <span class="va">pc_tree</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Access the dbh, residual and fdbh values from the output list</span></span>
<span><span class="va">dbh</span> <span class="op">&lt;-</span> <span class="va">out_dbh</span><span class="op">$</span><span class="va">dbh</span></span>
<span><span class="va">residual_dbh</span> <span class="op">&lt;-</span> <span class="va">out_dbh</span><span class="op">$</span><span class="va">R2</span></span>
<span><span class="va">fdbh</span> <span class="op">&lt;-</span> <span class="va">out_dbh</span><span class="op">$</span><span class="va">fdbh</span></span>
<span><span class="co"># Use dab_pc function with default parameters and plot the fit</span></span>
<span><span class="va">out_dab</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dab_pc.html">dab_pc</a></span><span class="op">(</span>pc <span class="op">=</span> <span class="va">pc_tree</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Access the dab, residual and fdab values from the output list</span></span>
<span><span class="va">ddab</span> <span class="op">&lt;-</span> <span class="va">out_dab</span><span class="op">$</span><span class="va">dab</span></span>
<span><span class="va">residual_dab</span> <span class="op">&lt;-</span> <span class="va">out_dab</span><span class="op">$</span><span class="va">R2</span></span>
<span><span class="va">fdab</span> <span class="op">&lt;-</span> <span class="va">out_dab</span><span class="op">$</span><span class="va">fdab</span></span></code></pre></div>
<p align="center">
<img src="reference/figures/diameter_slice_example_butt.jpeg" height="500"></p>
<p align="center">
<img src="reference/figures/dab_example.jpeg" height="500"></p>
<p>Calculating the stem branch distance of a TreeQSM:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lmterryn/ITSMe" class="external-link">ITSMe</a></span><span class="op">)</span></span>
<span><span class="co"># Read the TreeQSM file from the Specified path to the TreeQSM file</span></span>
<span><span class="va">qsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_tree_qsm.html">read_tree_qsm</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"path/to/QSM.mat"</span><span class="op">)</span></span>
<span><span class="co"># Use stem_branch_distance_qsm function</span></span>
<span><span class="va">sbd</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/stem_branch_distance_qsm.html">stem_branch_distance_qsm</a></span><span class="op">(</span></span>
<span>  cylinder <span class="op">=</span> <span class="va">qsm</span><span class="op">$</span><span class="va">cylinder</span>,</span>
<span>  treedata <span class="op">=</span> <span class="va">qsm</span><span class="op">$</span><span class="va">treedata</span>, normalisation <span class="op">=</span> <span class="st">"dbh"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Using the point cloud information for more accurate dbh normalisation</span></span>
<span><span class="va">pc_tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_tree_pc.html">read_tree_pc</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"path/to/point/cloud.txt"</span><span class="op">)</span></span>
<span><span class="va">sbd</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/stem_branch_distance_qsm.html">stem_branch_distance_qsm</a></span><span class="op">(</span></span>
<span>  cylinder <span class="op">=</span> <span class="va">qsm</span><span class="op">$</span><span class="va">cylinder</span>,</span>
<span>  treedata <span class="op">=</span> <span class="va">qsm</span><span class="op">$</span><span class="va">treedata</span>, normalisation <span class="op">=</span> <span class="st">"dbh"</span>,</span>
<span>  pc <span class="op">=</span> <span class="va">pc_tree</span>, buttress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Calculating a summary data.frame with the basic structural metrics (tree position, dbh, dab, tree height, projected area, 3D alpha volume) that can be obtained from individual tree point clouds for all point clouds in a specific folder:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lmterryn/ITSMe" class="external-link">ITSMe</a></span><span class="op">)</span></span>
<span><span class="co"># Run summary function with default parameter settings</span></span>
<span><span class="va">basic_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/summary_basic_pointcloud_metrics.html">summary_basic_pointcloud_metrics</a></span><span class="op">(</span></span>
<span>  PCs_path <span class="op">=</span> <span class="st">"path/to/point/cloud/folder/"</span>,</span>
<span>  OUT_path <span class="op">=</span> <span class="st">"path/to/output/folder/"</span><span class="op">)</span></span></code></pre></div>
<p>If you set the plot parameter TRUE and provide an OUT_path, this function saves a summary figure for each tree:</p>
<p align="center">
<img src="reference/figures/summary.jpeg" height="500"></p>
<p>Calculating a summary data.frame with the structural metrics defined by Terryn et al. (2020) for all TreeQSMs in a specific folder:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lmterryn/ITSMe" class="external-link">ITSMe</a></span><span class="op">)</span></span>
<span><span class="co"># Run summary function with default parameter settings</span></span>
<span><span class="va">qsm_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/summary_qsm_metrics.html">summary_qsm_metrics</a></span><span class="op">(</span></span>
<span>  QSMs_path <span class="op">=</span> <span class="st">"path/to/QSM/folder/"</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"2.3.0"</span>,</span>
<span>  PCs_path <span class="op">=</span> <span class="st">"path/to/point/cloud/folder/"</span>,</span>
<span>  extension <span class="op">=</span> <span class="st">".txt"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/lmterryn/ITSMe/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/lmterryn/ITSMe/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ITSMe</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Louise Terryn <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8405-2788" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louise Terryn.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
